#!/bin/bash

# This script displays the album cover art for the currently playing track in MPD (Music Player Daemon).
# It uses the mpc command-line tool to retrieve the album cover art information and then decodes
# the base64-encoded image data to render the album cover art to the terminal using ANSI escape sequences.

# Cobled together from other now playing scripts.
# with Base64 image code from https://github.com/uriel1998/vindauga
# Base64 encoded image found on Google Images

# BEGIN CONFIG
dir="/media/william/Data2/BACKUP/MP3/"
#MPD_HOST="192.168.1.80" # Uncomment for connecting to non local MPD instance
notify_duration="5000"
cache_dir="/media/william/DataOrig/MPD/.notify-cache/"
## END CONFIG

# This is a base64 endcoded image which will be used if nothing is found    
read -d '' DEFAULT_COVER << EOF
/9j/4AAQSkZJRgABAQEASABIAAD/4iOISUNDX1BST0ZJTEUAAQEAACN4bGNtcwIQAABtbnRyUkdC
IFhZWiAH3wALAAoADAASADhhY3NwKm5peAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA9tYAAQAA
AADTLWxjbXMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAtk
ZXNjAAABCAAAALBjcHJ0AAABuAAAARJ3dHB0AAACzAAAABRjaGFkAAAC4AAAACxyWFlaAAADDAAA
ABRiWFlaAAADIAAAABRnWFlaAAADNAAAABRyVFJDAAADSAAAIAxnVFJDAAADSAAAIAxiVFJDAAAD
SAAAIAxjaHJtAAAjVAAAACRkZXNjAAAAAAAAABxzUkdCLWVsbGUtVjItc3JnYnRyYy5pY2MAAAAA
AAAAAAAAAB0AcwBSAEcAQgAtAGUAbABsAGUALQBWADIALQBzAHIAZwBiAHQAcgBjAC4AaQBjAGMA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAHRleHQAAAAAQ29weXJpZ2h0IDIwMTUsIEVsbGUgU3RvbmUg
KHdlYnNpdGU6IGh0dHA6Ly9uaW5lZGVncmVlc2JlbG93LmNvbS87IGVtYWlsOiBlbGxlc3RvbmVA
bmluZWRlZ3JlZXNiZWxvdy5jb20pLiBUaGlzIElDQyBwcm9maWxlIGlzIGxpY2Vuc2VkIHVuZGVy
IGEgQ3JlYXRpdmUgQ29tbW9ucyBBdHRyaWJ1dGlvbi1TaGFyZUFsaWtlIDMuMCBVbnBvcnRlZCBM
aWNlbnNlIChodHRwczovL2NyZWF0aXZlY29tbW9ucy5vcmcvbGljZW5zZXMvYnktc2EvMy4wL2xl
Z2FsY29kZSkuAAAAAFhZWiAAAAAAAAD21gABAAAAANMtc2YzMgAAAAAAAQxCAAAF3v//8yUAAAeT
AAD9kP//+6H///2iAAAD3AAAwG5YWVogAAAAAAAAb6AAADj1AAADkFhZWiAAAAAAAAAknwAAD4QA
ALbEWFlaIAAAAAAAAGKXAAC3hwAAGNljdXJ2AAAAAAAAEAAAAAABAAIABAAFAAYABwAJAAoACwAM
AA4ADwAQABEAEwAUABUAFgAYABkAGgAbABwAHgAfACAAIQAjACQAJQAmACgAKQAqACsALQAuAC8A
MAAyADMANAA1ADcAOAA5ADoAOwA9AD4APwBAAEIAQwBEAEUARwBIAEkASgBMAE0ATgBPAFEAUgBT
AFQAVQBXAFgAWQBaAFwAXQBeAF8AYQBiAGMAZABmAGcAaABpAGsAbABtAG4AbwBxAHIAcwB0AHYA
dwB4AHkAewB8AH0AfgCAAIEAggCDAIUAhgCHAIgAiQCLAIwAjQCOAJAAkQCSAJMAlQCWAJcAmACa
AJsAnACdAJ8AoAChAKIApAClAKYApwCoAKoAqwCsAK0ArwCwALEAsgC0ALUAtgC3ALkAugC7ALwA
vgC/AMAAwQDCAMQAxQDGAMcAyQDKAMsAzADOAM8A0ADRANMA1ADVANcA2ADZANoA3ADdAN4A4ADh
AOIA5ADlAOYA6ADpAOoA7ADtAO8A8ADxAPMA9AD2APcA+AD6APsA/QD+AP8BAQECAQQBBQEHAQgB
CgELAQ0BDgEPAREBEgEUARUBFwEYARoBGwEdAR8BIAEiASMBJQEmASgBKQErAS0BLgEwATEBMwE0
ATYBOAE5ATsBPAE+AUABQQFDAUUBRgFIAUoBSwFNAU8BUAFSAVQBVQFXAVkBWgFcAV4BYAFhAWMB
ZQFnAWgBagFsAW4BbwFxAXMBdQF2AXgBegF8AX4BfwGBAYMBhQGHAYkBigGMAY4BkAGSAZQBlgGX
AZkBmwGdAZ8BoQGjAaUBpwGpAasBrAGuAbABsgG0AbYBuAG6AbwBvgHAAcIBxAHGAcgBygHMAc4B
0AHSAdQB1gHYAdoB3AHeAeEB4wHlAecB6QHrAe0B7wHxAfMB9QH4AfoB/AH+AgACAgIEAgcCCQIL
Ag0CDwISAhQCFgIYAhoCHQIfAiECIwIlAigCKgIsAi4CMQIzAjUCOAI6AjwCPgJBAkMCRQJIAkoC
TAJPAlECUwJWAlgCWgJdAl8CYQJkAmYCaQJrAm0CcAJyAnUCdwJ5AnwCfgKBAoMChgKIAosCjQKQ
ApIClQKXApoCnAKfAqECpAKmAqkCqwKuArACswK1ArgCuwK9AsACwgLFAsgCygLNAs8C0gLVAtcC
2gLdAt8C4gLkAucC6gLsAu8C8gL1AvcC+gL9Av8DAgMFAwgDCgMNAxADEwMVAxgDGwMeAyADIwMm
AykDLAMuAzEDNAM3AzoDPQM/A0IDRQNIA0sDTgNRA1QDVgNZA1wDXwNiA2UDaANrA24DcQN0A3cD
egN9A4ADggOFA4gDiwOOA5EDlAOYA5sDngOhA6QDpwOqA60DsAOzA7YDuQO8A78DwgPFA8kDzAPP
A9ID1QPYA9sD3wPiA+UD6APrA+4D8gP1A/gD+wP+BAIEBQQIBAsEDwQSBBUEGAQcBB8EIgQlBCkE
LAQvBDMENgQ5BD0EQARDBEcESgRNBFEEVARXBFsEXgRiBGUEaARsBG8EcwR2BHkEfQSABIQEhwSL
BI4EkgSVBJkEnASgBKMEpwSqBK4EsQS1BLgEvAS/BMMExgTKBM4E0QTVBNgE3ATgBOME5wTqBO4E
8gT1BPkE/QUABQQFCAULBQ8FEwUWBRoFHgUiBSUFKQUtBTEFNAU4BTwFQAVDBUcFSwVPBVIFVgVa
BV4FYgVmBWkFbQVxBXUFeQV9BYEFhAWIBYwFkAWUBZgFnAWgBaQFqAWsBa8FswW3BbsFvwXDBccF
ywXPBdMF1wXbBd8F4wXnBesF7wX0BfgF/AYABgQGCAYMBhAGFAYYBhwGIQYlBikGLQYxBjUGOQY+
BkIGRgZKBk4GUwZXBlsGXwZjBmgGbAZwBnQGeQZ9BoEGhQaKBo4GkgaXBpsGnwakBqgGrAaxBrUG
uQa+BsIGxgbLBs8G1AbYBtwG4QblBuoG7gbyBvcG+wcABwQHCQcNBxIHFgcbBx8HJAcoBy0HMQc2
BzoHPwdDB0gHTQdRB1YHWgdfB2MHaAdtB3EHdgd7B38HhAeJB40HkgeXB5sHoAelB6kHrgezB7cH
vAfBB8YHygfPB9QH2QfdB+IH5wfsB/EH9Qf6B/8IBAgJCA0IEggXCBwIIQgmCCsILwg0CDkIPghD
CEgITQhSCFcIXAhhCGYIawhwCHUIegh/CIQIiQiOCJMImAidCKIIpwisCLEItgi7CMAIxQjKCM8I
1AjZCN8I5AjpCO4I8wj4CP0JAwkICQ0JEgkXCR0JIgknCSwJMQk3CTwJQQlGCUwJUQlWCVsJYQlm
CWsJcQl2CXsJgQmGCYsJkQmWCZsJoQmmCasJsQm2CbwJwQnGCcwJ0QnXCdwJ4gnnCe0J8gn4Cf0K
AgoICg0KEwoZCh4KJAopCi8KNAo6Cj8KRQpKClAKVgpbCmEKZgpsCnIKdwp9CoMKiAqOCpQKmQqf
CqUKqgqwCrYKvArBCscKzQrTCtgK3grkCuoK7wr1CvsLAQsHCwwLEgsYCx4LJAsqCy8LNQs7C0EL
RwtNC1MLWQtfC2QLagtwC3YLfAuCC4gLjguUC5oLoAumC6wLsgu4C74LxAvKC9AL1gvcC+IL6Qvv
C/UL+wwBDAcMDQwTDBkMIAwmDCwMMgw4DD4MRQxLDFEMVwxdDGQMagxwDHYMfQyDDIkMjwyWDJwM
ogyoDK8MtQy7DMIMyAzODNUM2wzhDOgM7gz1DPsNAQ0IDQ4NFQ0bDSENKA0uDTUNOw1CDUgNTw1V
DVwNYg1pDW8Ndg18DYMNiQ2QDZYNnQ2kDaoNsQ23Db4NxQ3LDdIN2Q3fDeYN7A3zDfoOAQ4HDg4O
FQ4bDiIOKQ4vDjYOPQ5EDkoOUQ5YDl8OZg5sDnMOeg6BDogOjg6VDpwOow6qDrEOuA6+DsUOzA7T
DtoO4Q7oDu8O9g79DwQPCw8SDxkPIA8nDy4PNQ88D0MPSg9RD1gPXw9mD20PdA97D4IPiQ+QD5gP
nw+mD60PtA+7D8IPyg/RD9gP3w/mD+0P9Q/8EAMQChASEBkQIBAnEC8QNhA9EEQQTBBTEFoQYhBp
EHAQeBB/EIYQjhCVEJ0QpBCrELMQuhDCEMkQ0BDYEN8Q5xDuEPYQ/REFEQwRFBEbESMRKhEyETkR
QRFIEVARVxFfEWcRbhF2EX0RhRGNEZQRnBGkEasRsxG7EcIRyhHSEdkR4RHpEfAR+BIAEggSDxIX
Eh8SJxIuEjYSPhJGEk4SVRJdEmUSbRJ1En0ShBKMEpQSnBKkEqwStBK8EsQSzBLUEtsS4xLrEvMS
+xMDEwsTExMbEyMTKxMzEzsTRBNME1QTXBNkE2wTdBN8E4QTjBOUE50TpROtE7UTvRPFE80T1hPe
E+YT7hP2E/8UBxQPFBcUIBQoFDAUOBRBFEkUURRaFGIUahRzFHsUgxSMFJQUnBSlFK0UthS+FMYU
zxTXFOAU6BTxFPkVARUKFRIVGxUjFSwVNBU9FUUVThVXFV8VaBVwFXkVgRWKFZMVmxWkFawVtRW+
FcYVzxXYFeAV6RXyFfoWAxYMFhQWHRYmFi8WNxZAFkkWUhZaFmMWbBZ1Fn4WhhaPFpgWoRaqFrMW
uxbEFs0W1hbfFugW8Rb6FwMXDBcUFx0XJhcvFzgXQRdKF1MXXBdlF24XdxeAF4kXkhecF6UXrhe3
F8AXyRfSF9sX5BftF/cYABgJGBIYGxgkGC4YNxhAGEkYUhhcGGUYbhh3GIEYihiTGJwYphivGLgY
whjLGNQY3hjnGPAY+hkDGQwZFhkfGSkZMhk7GUUZThlYGWEZaxl0GX4ZhxmRGZoZpBmtGbcZwBnK
GdMZ3RnmGfAZ+hoDGg0aFhogGioaMxo9GkYaUBpaGmMabRp3GoEaihqUGp4apxqxGrsaxRrOGtga
4hrsGvUa/xsJGxMbHRsnGzAbOhtEG04bWBtiG2wbdRt/G4kbkxudG6cbsRu7G8UbzxvZG+Mb7Rv3
HAEcCxwVHB8cKRwzHD0cRxxRHFscZRxwHHochByOHJgcohysHLYcwRzLHNUc3xzpHPQc/h0IHRId
HB0nHTEdOx1FHVAdWh1kHW8deR2DHY4dmB2iHa0dtx3BHcwd1h3hHesd9R4AHgoeFR4fHioeNB4+
HkkeUx5eHmgecx59Hogekx6dHqgesh69Hsce0h7cHuce8h78HwcfEh8cHycfMh88H0cfUh9cH2cf
ch98H4cfkh+dH6cfsh+9H8gf0h/dH+gf8x/+IAggEyAeICkgNCA/IEogVCBfIGogdSCAIIsgliCh
IKwgtyDCIM0g2CDjIO4g+SEEIQ8hGiElITAhOyFGIVEhXCFnIXIhfiGJIZQhnyGqIbUhwCHMIdch
4iHtIfgiBCIPIhoiJSIwIjwiRyJSIl4iaSJ0In8iiyKWIqEirSK4IsMizyLaIuYi8SL8IwgjEyMf
IyojNSNBI0wjWCNjI28jeiOGI5EjnSOoI7QjvyPLI9Yj4iPuI/kkBSQQJBwkKCQzJD8kSyRWJGIk
biR5JIUkkSScJKgktCS/JMsk1yTjJO4k+iUGJRIlHiUpJTUlQSVNJVklZSVwJXwliCWUJaAlrCW4
JcQl0CXcJecl8yX/JgsmFyYjJi8mOyZHJlMmXyZrJncmhCaQJpwmqCa0JsAmzCbYJuQm8Cb9Jwkn
FSchJy0nOSdGJ1InXidqJ3YngyePJ5snpye0J8AnzCfZJ+Un8Sf9KAooFigjKC8oOyhIKFQoYCht
KHkohiiSKJ4oqyi3KMQo0CjdKOko9ikCKQ8pGykoKTQpQSlNKVopZylzKYApjCmZKaYpsim/Kcwp
2CnlKfEp/ioLKhgqJCoxKj4qSipXKmQqcSp9KooqlyqkKrEqvSrKKtcq5CrxKv4rCisXKyQrMSs+
K0srWCtlK3IrfyuMK5krpSuyK78rzCvZK+Yr8ywBLA4sGywoLDUsQixPLFwsaSx2LIMskCyeLKss
uCzFLNIs3yztLPotBy0ULSEtLy08LUktVi1kLXEtfi2LLZktpi2zLcEtzi3bLekt9i4ELhEuHi4s
LjkuRy5ULmEuby58Loouly6lLrIuwC7NLtsu6C72LwMvES8eLywvOi9HL1UvYi9wL34viy+ZL6cv
tC/CL9Av3S/rL/kwBjAUMCIwLzA9MEswWTBnMHQwgjCQMJ4wrDC5MMcw1TDjMPEw/zENMRoxKDE2
MUQxUjFgMW4xfDGKMZgxpjG0McIx0DHeMewx+jIIMhYyJDIyMkAyTjJcMmoyeTKHMpUyozKxMr8y
zTLcMuoy+DMGMxQzIzMxMz8zTTNcM2ozeDOGM5UzozOxM8AzzjPcM+sz+TQHNBY0JDQzNEE0TzRe
NGw0ezSJNJg0pjS1NMM00jTgNO80/TUMNRo1KTU3NUY1VDVjNXI1gDWPNZ01rDW7Nck12DXnNfU2
BDYTNiE2MDY/Nk42XDZrNno2iTaXNqY2tTbENtM24TbwNv83DjcdNyw3OzdJN1g3Zzd2N4U3lDej
N7I3wTfQN9837jf9OAw4GzgqODk4SDhXOGY4dTiEOJM4ojixOME40DjfOO44/TkMORs5Kzk6OUk5
WDlnOXc5hjmVOaQ5tDnDOdI54TnxOgA6DzofOi46PTpNOlw6azp7Ooo6mjqpOrg6yDrXOuc69jsG
OxU7JTs0O0Q7UztjO3I7gjuRO6E7sDvAO9A73zvvO/48DjwePC08PTxNPFw8bDx8PIs8mzyrPLo8
yjzaPOo8+T0JPRk9KT05PUg9WD1oPXg9iD2YPac9tz3HPdc95z33Pgc+Fz4nPjc+Rz5XPmc+dz6H
Ppc+pz63Psc+1z7nPvc/Bz8XPyc/Nz9HP1c/Zz94P4g/mD+oP7g/yD/ZP+k/+UAJQBlAKkA6QEpA
WkBrQHtAi0CcQKxAvEDNQN1A7UD+QQ5BHkEvQT9BT0FgQXBBgUGRQaJBskHDQdNB5EH0QgVCFUIm
QjZCR0JXQmhCeEKJQppCqkK7QstC3ELtQv1DDkMfQy9DQENRQ2FDckODQ5RDpEO1Q8ZD10PnQ/hE
CUQaRCtEO0RMRF1EbkR/RJBEoUSyRMJE00TkRPVFBkUXRShFOUVKRVtFbEV9RY5Fn0WwRcFF0kXj
RfRGBUYXRihGOUZKRltGbEZ9Ro9GoEaxRsJG00bkRvZHB0cYRylHO0dMR11HbkeAR5FHoke0R8VH
1kfoR/lICkgcSC1IP0hQSGFIc0iESJZIp0i5SMpI3EjtSP9JEEkiSTNJRUlWSWhJekmLSZ1JrknA
SdJJ40n1SgZKGEoqSjtKTUpfSnFKgkqUSqZKt0rJSttK7Ur/SxBLIks0S0ZLWEtpS3tLjUufS7FL
w0vVS+dL+UwKTBxMLkxATFJMZEx2TIhMmkysTL5M0EziTPRNBk0ZTStNPU1PTWFNc02FTZdNqU28
Tc5N4E3yTgROF04pTjtOTU5fTnJOhE6WTqlOu07NTt9O8k8ETxZPKU87T05PYE9yT4VPl0+qT7xP
zk/hT/NQBlAYUCtQPVBQUGJQdVCHUJpQrVC/UNJQ5FD3UQlRHFEvUUFRVFFnUXlRjFGfUbFRxFHX
UelR/FIPUiJSNFJHUlpSbVKAUpJSpVK4UstS3lLxUwRTFlMpUzxTT1NiU3VTiFObU65TwVPUU+dT
+lQNVCBUM1RGVFlUbFR/VJJUpVS4VMtU3lTyVQVVGFUrVT5VUVVlVXhVi1WeVbFVxVXYVetV/lYS
ViVWOFZLVl9WclaFVplWrFa/VtNW5lb6Vw1XIFc0V0dXW1duV4JXlVepV7xX0FfjV/dYClgeWDFY
RVhYWGxYgFiTWKdYuljOWOJY9VkJWR1ZMFlEWVhZa1l/WZNZp1m6Wc5Z4ln2WglaHVoxWkVaWVps
WoBalFqoWrxa0FrkWvhbC1sfWzNbR1tbW29bg1uXW6tbv1vTW+db+1wPXCNcN1xLXGBcdFyIXJxc
sFzEXNhc7F0BXRVdKV09XVFdZV16XY5dol22Xctd313zXgheHF4wXkReWV5tXoJell6qXr9e017n
XvxfEF8lXzlfTl9iX3dfi1+gX7RfyV/dX/JgBmAbYC9gRGBYYG1ggmCWYKtgv2DUYOlg/WESYSdh
O2FQYWVhemGOYaNhuGHNYeFh9mILYiBiNWJJYl5ic2KIYp1ismLHYtti8GMFYxpjL2NEY1ljbmOD
Y5hjrWPCY9dj7GQBZBZkK2RAZFVkamR/ZJVkqmS/ZNRk6WT+ZRNlKWU+ZVNlaGV9ZZNlqGW9ZdJl
6GX9ZhJmJ2Y9ZlJmZ2Z9ZpJmp2a9ZtJm6Gb9ZxJnKGc9Z1NnaGd+Z5NnqWe+Z9Rn6Wf/aBRoKmg/
aFVoamiAaJZoq2jBaNZo7GkCaRdpLWlDaVhpbmmEaZlpr2nFadtp8GoGahxqMmpIal1qc2qJap9q
tWrKauBq9msMayJrOGtOa2RremuQa6ZrvGvSa+hr/mwUbCpsQGxWbGxsgmyYbK5sxGzabPBtBm0c
bTNtSW1fbXVti22hbbhtzm3kbfpuEW4nbj1uU25qboBulm6tbsNu2W7wbwZvHG8zb0lvYG92b4xv
o2+5b9Bv5m/9cBNwKnBAcFdwbXCEcJpwsXDHcN5w9HELcSJxOHFPcWZxfHGTcapxwHHXce5yBHIb
cjJySHJfcnZyjXKkcrpy0XLocv9zFnMsc0NzWnNxc4hzn3O2c81z5HP6dBF0KHQ/dFZ0bXSEdJt0
snTJdOB093UOdSZ1PXVUdWt1gnWZdbB1x3XedfZ2DXYkdjt2UnZqdoF2mHavdsd23nb1dwx3JHc7
d1J3aneBd5h3sHfHd9539ngNeCV4PHhUeGt4gniaeLF4yXjgePh5D3kneT55VnlueYV5nXm0ecx5
43n7ehN6KnpCelp6cXqJeqF6uHrQeuh7AHsXey97R3tfe3Z7jnume7571nvufAV8HXw1fE18ZXx9
fJV8rXzFfNx89H0MfSR9PH1UfWx9hH2cfbR9zX3lff1+FX4tfkV+XX51fo1+pX6+ftZ+7n8Gfx5/
N39Pf2d/f3+Xf7B/yH/gf/mAEYApgEGAWoBygIqAo4C7gNSA7IEEgR2BNYFOgWaBf4GXgbCByIHh
gfmCEoIqgkOCW4J0goyCpYK+gtaC74MHgyCDOYNRg2qDg4Obg7SDzYPlg/6EF4QwhEiEYYR6hJOE
rITEhN2E9oUPhSiFQYVahXKFi4Wkhb2F1oXvhgiGIYY6hlOGbIaFhp6Gt4bQhumHAocbhzSHTYdn
h4CHmYeyh8uH5If9iBeIMIhJiGKIe4iViK6Ix4jgiPqJE4ksiUaJX4l4iZGJq4nEid6J94oQiiqK
Q4pdinaKj4qpisKK3Ir1iw+LKItCi1uLdYuOi6iLwovbi/WMDowojEKMW4x1jI+MqIzCjNyM9Y0P
jSmNQo1cjXaNkI2pjcON3Y33jhGOK45Ejl6OeI6SjqyOxo7gjvqPE48tj0ePYY97j5WPr4/Jj+OP
/ZAXkDGQS5BlkH+QmpC0kM6Q6JECkRyRNpFQkWuRhZGfkbmR05HukgiSIpI8kleScZKLkqaSwJLa
kvSTD5Mpk0STXpN4k5OTrZPIk+KT/JQXlDGUTJRmlIGUm5S2lNCU65UFlSCVO5VVlXCVipWllcCV
2pX1lg+WKpZFll+WepaVlrCWypbllwCXG5c1l1CXa5eGl6GXu5fWl/GYDJgnmEKYXZh3mJKYrZjI
mOOY/pkZmTSZT5lqmYWZoJm7mdaZ8ZoMmieaQppemnmalJqvmsqa5ZsAmxybN5tSm22biJukm7+b
2pv1nBGcLJxHnGOcfpyZnLWc0JzrnQedIp09nVmddJ2Qnaudxp3inf2eGZ40nlCea56HnqKevp7a
nvWfEZ8sn0ifY59/n5uftp/Sn+6gCaAloEGgXKB4oJSgsKDLoOehA6EfoTqhVqFyoY6hqqHGoeGh
/aIZojWiUaJtoomipaLBot2i+aMVozGjTaNpo4WjoaO9o9mj9aQRpC2kSaRlpIGknqS6pNak8qUO
pSqlR6VjpX+lm6W4pdSl8KYMpimmRaZhpn6mmqa2ptOm76cLpyinRKdgp32nmae2p9Kn76gLqCio
RKhhqH2omqi2qNOo76kMqSmpRaliqX6pm6m4qdSp8aoOqiqqR6pkqoCqnaq6qteq86sQqy2rSqtn
q4OroKu9q9qr96wUrDCsTaxqrIespKzBrN6s+60YrTWtUq1vrYytqa3GreOuAK4drjquV650rpKu
r67MrumvBq8jr0CvXq97r5ivta/Tr/CwDbAqsEiwZbCCsJ+wvbDasPexFbEysVCxbbGKsaixxbHj
sgCyHrI7slmydrKUsrGyz7LsswqzJ7NFs2KzgLOes7uz2bP2tBS0MrRPtG20i7SotMa05LUCtR+1
PbVbtXm1lrW0tdK18LYOtiy2SbZntoW2o7bBtt+2/bcbtzm3V7d1t5O3sbfPt+24C7gpuEe4ZbiD
uKG4v7jduPu5Gbk4uVa5dLmSubC5zrntugu6KbpHuma6hLqiusC637r9uxu7OrtYu3a7lbuzu9G7
8LwOvC28S7xqvIi8przFvOO9Ar0gvT+9Xb18vZu9ub3Yvfa+Fb4zvlK+cb6Pvq6+zb7rvwq/Kb9H
v2a/hb+kv8K/4cAAwB/APsBcwHvAmsC5wNjA98EVwTTBU8FywZHBsMHPwe7CDcIswkvCasKJwqjC
x8LmwwXDJMNDw2LDgcOgw8DD38P+xB3EPMRbxHvEmsS5xNjE98UXxTbFVcV1xZTFs8XSxfLGEcYw
xlDGb8aPxq7GzcbtxwzHLMdLx2vHiseqx8nH6cgIyCjIR8hnyIbIpsjFyOXJBckkyUTJZMmDyaPJ
w8niygLKIspBymHKgcqhysDK4MsAyyDLQMtfy3/Ln8u/y9/L/8wfzD/MXsx+zJ7MvszezP7NHs0+
zV7Nfs2ezb7N3s3+zh/OP85fzn/On86/zt/O/88gz0DPYM+Az6DPwc/h0AHQIdBC0GLQgtCi0MPQ
49ED0STRRNFl0YXRpdHG0ebSB9In0kfSaNKI0qnSydLq0wrTK9NM02zTjdOt087T7tQP1DDUUNRx
1JLUstTT1PTVFNU11VbVd9WX1bjV2dX61hrWO9Zc1n3Wnta/1t/XANch10LXY9eE16XXxtfn2AjY
KdhK2GvYjNit2M7Y79kQ2THZUtlz2ZTZtdnW2fjaGdo62lvafNqe2r/a4NsB2yLbRNtl24bbqNvJ
2+rcC9wt3E7cb9yR3LLc1Nz13RbdON1Z3XvdnN2+3d/eAd4i3kTeZd6H3qjeyt7s3w3fL99Q33Lf
lN+139ff+eAa4DzgXuB/4KHgw+Dl4QbhKOFK4WzhjeGv4dHh8+IV4jfiWeJ64pzivuLg4wLjJONG
42jjiuOs487j8OQS5DTkVuR45JrkvOTe5QHlI+VF5WflieWr5c3l8OYS5jTmVuZ55pvmvebf5wLn
JOdG52nni+et59Dn8ugU6DfoWeh76J7owOjj6QXpKOlK6W3pj+my6dTp9+oZ6jzqXuqB6qTqxurp
6wvrLutR63Prluu569zr/uwh7ETsZuyJ7Kzsz+zy7RTtN+1a7X3toO3D7eXuCO4r7k7uce6U7rfu
2u797yDvQ+9m74nvrO/P7/LwFfA48FvwfvCh8MXw6PEL8S7xUfF08Zjxu/He8gHyJPJI8mvyjvKx
8tXy+PMb8z/zYvOF86nzzPPw9BP0NvRa9H30ofTE9Oj1C/Uv9VL1dvWZ9b314PYE9if2S/Zv9pL2
tvbZ9v33IfdE92j3jPew99P39/gb+D74YviG+Kr4zvjx+RX5Ofld+YH5pfnJ+ez6EPo0+lj6fPqg
+sT66PsM+zD7VPt4+5z7wPvk/Aj8LPxQ/HX8mfy9/OH9Bf0p/U39cv2W/br93v4C/if+S/5v/pT+
uP7c/wD/Jf9J/23/kv+2/9v//2Nocm0AAAAAAAMAAAAAo9cAAFR8AABMzQAAmZoAACZnAAAPXP/b
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
W2bbbfHvg23wbbbbbbbbztttttttvO2287b4xt8G2222lvG22222223W222223h423/Jvj22223j
bfpbbbb49/4m2/7W222222222/8AC3jbf9P/2Q==
EOF

fallback_image="$cache_dir/unknown.jpg"

    if [ -d "$cache_dir" ];then
        hasimgs=$(ls "$cache_dir" | egrep "jpeg|jpg|png|gif" -c )
        if [ $hasimgs -lt 1 ]; then
            if [ ! -f "$fallback_image" ];then
                echo "$DEFAULT_COVER" | base64 --decode > "$cache_dir/unknown.jpg"
                fallback_image="$cache_dir/unknown.jpg"
                placeholder_dir=""      # the directory didn't have images
            fi
        else
            fallback_image=""
        fi
    else
        if [ ! -f "$fallback_image" ];then
            echo "$DEFAULT_COVER" | base64 --decode > "$cache_dir/unknown.jpg"
            fallback_image="$cache_dir/unknown.jpg"
        fi
    fi

    # Logic here - if there's a placeholder directory with png or jpg in it, 
    # use that.  If not, see if there's a specific placeholder image. If not,
    # then output one.


#Get all the info needed to create the notify-send message, albumartist, album,title, cover image.
output=$(mpc -f "%title%\n%albumartist%\n%album%\n%file%" current)

#Get mpd status
# Check if MPD_HOST is uncommented and has a value
if [ -n "${MPD_HOST}" ]; then
    # Use mpc with MPD_HOST if it's set
    status=$(mpc -h "${MPD_HOST}" -p 6600 | grep playing | cut -c2-8)
    status2=$(mpc -h "${MPD_HOST}" -p 6600 | grep pause | cut -c2-7)
else
    # Use default behavior if MPD_HOST is not set
    status=$(mpc | grep playing | cut -c2-8)
    status2=$(mpc | grep pause | cut -c2-7)
fi

#echo "$status"
if [ “$status” == “playing” ]; then
status=playing
elif [[ “$status2” == “paused” ]]; then
status=paused
else
status=stopped
fi

if [ $? -ne 1 ]
then
	i=1
	while read -r line; do
		array[$i]="$line"
		(( i++ ))
	done <<< "$output"

	array[1]=$(echo "${array[1]}" | sed s/\&/\&amp\;/)
	array[2]=$(echo "${array[2]}" | sed s/\&/\&amp\;/)
	array[3]=$(echo "${array[3]}" | sed s/\&/\&amp\;/)

	file=$(ls -t "$(dirname "$dir${array[4]}")"/*.{jpg,png} 2> /dev/null | head -n 1)
fi

if [[ -f "$file" && “$status” == “playing” ]]; then
	notify-send "${array[1]}" "${array[2]}\n${array[3]}" -t $notify_duration -i "$file"
elif [[ -f "$file" && “$status” == “paused” ]]; then
	notify-send "${array[1]}" "${array[2]}\n${array[3]} ($status)" -t $notify_duration -i "$file"
elif [[ ! -f "$file" && “$status” == “playing” ]]; then
	notify-send "${array[1]}" "${array[2]}\n${array[3]}" -t $notify_duration -i "${fallback_image}"
elif [[ ! -f "$file" && “$status” == “paused” ]]; then
	notify-send "${array[1]}" "${array[2]}\n${array[3]} ($status)" -t $notify_duration -i "${fallback_image}"
else [[ “$status” == “stopped” ]]
    notify-send -i "${fallback_image}" -t $notify_duration "MPD client $status"
fi
